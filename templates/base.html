<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="shortcut icon" href="static/favicon.png">
    <title> Teste </title>
</head>
<body>

<div class="d-flex">
<nav class="sidebar bg-dark w-25 ">
        <div class="d-flex flex-column align-items-start text-center">
            <h4 class="text-white p-3 border-bottom w-100">Sensores</h4>
            <ul id="SensorList" class="nav nav-pills flex-column mb-auto w-100">
            </ul>
        </div>
    </nav>

    <div id="graphSection" class="border border-4 rounded-3 p-4 m-3 w-75" >

        <img class="w-50 mx-auto d-block " id="tempGraph" src="" alt="">
        <img class="w-50 mx-auto d-block " id="umiGraph" src="" alt="">
        <img class="w-50 mx-auto d-block " id="dustGraph" src="" alt="">


    </div>

</div>

<script>

function setCurrentId(id){

    const tempGraphURL = "/static/tempGraph/"
    const umiGraphURL = "/static/umiGraph/"
    const dustGraphURL = "/static/dustGraph/"

    
    document.getElementById("tempGraph").src = tempGraphURL+id+".png";
    document.getElementById("umiGraph").src = umiGraphURL+id+".png";
    document.getElementById("dustGraph").src = dustGraphURL+id+".png";

}

function getActiveSensors(){

    fetch("http://localhost:8000/activeSensors").then(response => response.json()).then(
        data => {
        const sensorList = data.sensors;
        console.log(sensorList);

        const items = document.getElementById("SensorList").querySelectorAll("li");

        console.log(items)

        items.forEach(element => {
            if(sensorList.includes(Number(element.id)) == false){
                element.querySelector("button").classList.remove("btn-info");
                element.querySelector("button").classList.add("btn-warning");
            }
            
        });

        }
    )
    

}

const minuteInterval = 30;
setInterval(getActiveSensors, minuteInterval*60*1000);

window.onload = function(){
    getActiveSensors();
}

</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>